# to build the image
nginx_ssh$ docker build -t nginx_ssh:latest .

# to pull the image from dockerhub
docker login # if not already logged in
docker pull pstivers3/nginx_ssh:latest

# to run the contaners in docker
docker run -d --name ssh-client nginx_ssh:latest
docker run -d --name ssh-server nginx_ssh:latest

docker exec -it ssh-server /bin/bash -c 'service ssh start'
docker exec -it ssh-server /bin/bash -c 'hostname -i' # use the output IP address in the ssh commands below

# to bind to the ssh-client container command line in docker
docker exec -it ssh-client /bin/bash

# to run the containers in kubernetes
kubectl run ssh-client --image=pstivers3/nginx_ssh:latest
kubectl run ssh-server --image=pstivers3/nginx_ssh:latest

kubectl exec -it ssh-server -- /bin/bash -c 'service ssh start'
kubectl exec -it ssh-server -- /bin/bash -c 'hostname -i' # use the output IP address in the ssh commands below

# to bind to the ssh-client container command line in kubernetes
kubectl exec -it ssh-client -- /bin/bash

# test the containers from command line of ssh-client
/# ssh -i /home/deploy/.ssh/id_rsa deploy@<ip of ssh-server> 'echo "$(whoami)@$(hostname -i) says success!"'
/# su - deploy
$ ssh deploy@<ip of ssh-server> 'echo "$(whoami)@$(hostname -i) says success!"'

